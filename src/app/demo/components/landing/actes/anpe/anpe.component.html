<div class="surface-0">
    <div class="guide-wrapper overflow-hidden">
        <app-header></app-header>  
        <!-- Hero Section -->
        <div class="bg-green-800 text-white px-4 py-8 md:px-6 lg:px-8">
            <div class="text-center">
                <h1 class="text-5xl font-bold mb-4">Formulaire de demande d'une attestation ANPE</h1>
            </div>
        </div>        
        <div class="px-4 py-8 md:px-6 lg:px-8">
            <p-steps [model]="items" [activeIndex]="currentStep"></p-steps>
            
            <div class="mt-4">
                <p-card>
                    <form (ngSubmit)="onSubmit()" #anpeForm="ngForm">
                        <!-- Step 1: Informations du contrat -->
                        <div [hidden]="currentStep !== 0">
                            <p-fieldset legend="Informations du contrat">
                                <div class="p-fluid p-formgrid grid">
                                    <div class="col-4 mt-2">
                                        <span>Reference du contrat</span>
                                        <input [(ngModel)]="formData.contractReference" name="contractReference" pInputText required />
                                    </div>
                                    <div class="col-8 mt-2">
                                        <span>Objet du contrat</span>
                                        <input [(ngModel)]="formData.contractPurpose" name="contractPurpose" pInputText required />
                                    </div>
                                    <div class="col-5 mt-2">
                                        <span>Identité de l'organisme attribuant le marché</span>
                                        <input [(ngModel)]="formData.contractingOrganizationName" name="contractingOrganizationName" pInputText required />
                                    </div>
                                    <div class="col-4 mt-2">
                                        <span>Adresse</span>
                                        <input [(ngModel)]="formData.organizationAddress" name="organizationAddress" pInputText required />
                                    </div>
                                    <div class="col-3 mt-2">
                                        <span>Numéro de téléphone</span>
                                        <input [(ngModel)]="formData.organizationPhone" name="organizationPhone" pInputText required />
                                    </div>
                                </div>
                            </p-fieldset>
                        </div>

                        <!-- Step 2: Situation de l'employeur -->
                        <div [hidden]="currentStep !== 1">
                            <p-fieldset legend="Déclaration de la situation de l'employeur">
                                <div class="p-fluid p-formgrid grid">
                                    <div class="col-3 mt-2">
                                        <span>Numéro d'identification</span>
                                        <input [(ngModel)]="formData.employerIdentification" name="employerIdentification" pInputText required />
                                    </div>
                                    <div class="col-3 mt-2">
                                        <span>Province</span>
                                        <input [(ngModel)]="formData.province" name="province" pInputText required />
                                    </div>
                                    <div class="col-3 mt-2">
                                        <span>Commune</span>
                                        <input [(ngModel)]="formData.commune" name="commune" pInputText required />
                                    </div>
                                    <div class="col-3 mt-2">
                                        <span>Rue</span>
                                        <input [(ngModel)]="formData.street" name="street" pInputText required />
                                    </div>
                                    <div class="col-6 mt-2">
                                        <span>Secteur d'activité</span>
                                        <input [(ngModel)]="formData.activitySector" name="activitySector" pInputText required />
                                    </div>
                                </div>
                            </p-fieldset>
                        </div>

                        <!-- Step 3: Renseignements sur l'établissement -->
                        <div [hidden]="currentStep !== 2">
                            <p-fieldset legend="Identification de l'établissement">
                                <div class="p-fluid p-formgrid grid">
                                    <div class="col-6 mt-2">
                                        <span>Dénomination de l'établissement</span>
                                        <input [(ngModel)]="formData.establishmentName" name="establishmentName" pInputText required />
                                    </div>
                                    <div class="col-3 mt-2">
                                        <span>Nom du responsable</span>
                                        <input [(ngModel)]="formData.managerLastName" name="managerLastName" pInputText required />
                                    </div>
                                    <div class="col-3 mt-2">
                                        <span>Prénom du responsable</span>
                                        <input [(ngModel)]="formData.managerFirstName" name="managerFirstName" pInputText required />
                                    </div>
                                    <div class="col-4 mt-2">
                                        <span>Date d'ouverture</span>
                                        <p-calendar [(ngModel)]="formData.openingDate" name="openingDate" [showIcon]="true" required></p-calendar>
                                    </div>
                                    <div class="col-4 mt-2">
                                        <span>Numéro d'adhérent CNSS</span>
                                        <input [(ngModel)]="formData.cnssNumber" name="cnssNumber" pInputText required />
                                    </div>
                                    <div class="col-6 mt-2">
                                        <span>Activité principale</span>
                                        <input [(ngModel)]="formData.mainActivity" name="mainActivity" pInputText required />
                                    </div>
                                    <div class="col-6 mt-2">
                                        <span>Activité secondaire</span>
                                        <input [(ngModel)]="formData.secondaryActivity" name="secondaryActivity" pInputText />
                                    </div>
                                </div>
                            </p-fieldset>

                            <p-fieldset legend="Effectifs" class="mt-3">
                                <div class="p-fluid p-formgrid grid">
                                    <div class="col-4 mt-2">
                                        <span>Travailleurs permanents</span>
                                        <p-inputNumber [(ngModel)]="formData.permanentWorkers" name="permanentWorkers" required></p-inputNumber>
                                    </div>
                                    <div class="col-4 mt-2">
                                        <span>Travailleurs temporaires</span>
                                        <p-inputNumber [(ngModel)]="formData.temporaryWorkers" name="temporaryWorkers" required></p-inputNumber>
                                    </div>
                                    <div class="col-4 mt-2">
                                        <span>Apprentis en poste</span>
                                        <p-inputNumber [(ngModel)]="formData.apprentices" name="apprentices" required></p-inputNumber>
                                    </div>
                                    <div class="col-4 mt-2">
                                        <span>Stagiaires en poste</span>
                                        <p-inputNumber [(ngModel)]="formData.interns" name="interns" required></p-inputNumber>
                                    </div>
                                </div>
                            </p-fieldset>

                            <p-fieldset legend="Périodes d'emploi" class="mt-3">
                                <div class="p-fluid p-formgrid grid">
                                    <div class="col-6">
                                        <h4>Période de plein emploi</h4>
                                        <div class="grid">
                                            <div class="col-6">
                                                <span>De</span>
                                                <p-calendar [(ngModel)]="formData.fullEmploymentStart" name="fullEmploymentStart" [showIcon]="true"></p-calendar>
                                            </div>
                                            <div class="col-6">
                                                <span>À</span>
                                                <p-calendar [(ngModel)]="formData.fullEmploymentEnd" name="fullEmploymentEnd" [showIcon]="true"></p-calendar>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-6">
                                        <h4>Période de baisse d'emploi</h4>
                                        <div class="grid">
                                            <div class="col-6">
                                                <span>De</span>
                                                <p-calendar [(ngModel)]="formData.lowEmploymentStart" name="lowEmploymentStart" [showIcon]="true"></p-calendar>
                                            </div>
                                            <div class="col-6">
                                                <span>À</span>
                                                <p-calendar [(ngModel)]="formData.lowEmploymentEnd" name="lowEmploymentEnd" [showIcon]="true"></p-calendar>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </p-fieldset>
                        </div>

                        <!-- Step 4: Intentions et besoins -->
                        <div [hidden]="currentStep !== 3">
                            <p-fieldset legend="Intentions de l'établissement">
                                <div class="p-fluid p-formgrid grid">
                                    <div class="col-6">
                                        <h4>Renforcement d'effectifs</h4>
                                        <div class="grid">
                                            <div class="col-6">
                                                <span>Pour l'année en cours</span>
                                                <p-selectButton [options]="yesNoOptions" [(ngModel)]="formData.currentYearRecruitment" name="currentYearRecruitment" optionLabel="label" optionValue="value"></p-selectButton>
                                            </div>
                                            <div class="col-6">
                                                <span>Pour l'année à venir</span>
                                                <p-selectButton [options]="yesNoOptions" [(ngModel)]="formData.nextYearRecruitment" name="nextYearRecruitment" optionLabel="label" optionValue="value"></p-selectButton>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-6">
                                        <h4>Compression d'effectifs</h4>
                                        <p-selectButton [options]="yesNoOptions" [(ngModel)]="formData.staffReduction" name="staffReduction" optionLabel="label" optionValue="value"></p-selectButton>
                                    </div>
                                </div>
                            </p-fieldset>

                            <p-fieldset legend="Besoins en formation" class="mt-3">
                                <div class="p-fluid p-formgrid grid">
                                    <div class="col-8">
                                        <span>Domaine</span>
                                        <input [(ngModel)]="formData.trainingDomain" name="trainingDomain" pInputText />
                                    </div>
                                    <div class="col-4">
                                        <span>Nombre à former</span>
                                        <p-inputNumber [(ngModel)]="formData.trainingCount" name="trainingCount"></p-inputNumber>
                                    </div>
                                </div>
                            </p-fieldset>

                            <p-fieldset legend="Besoins en perfectionnement" class="mt-3">
                                <div class="p-fluid p-formgrid grid">
                                    <div class="col-8">
                                        <span>Modules</span>
                                        <input [(ngModel)]="formData.perfectionnementModules" name="perfectionnementModules" pInputText />
                                    </div>
                                    <div class="col-4">
                                        <span>Nombre de participants</span>
                                        <p-inputNumber [(ngModel)]="formData.perfectionnementCount" name="perfectionnementCount"></p-inputNumber>
                                    </div>
                                </div>
                            </p-fieldset>

                            <p-fieldset legend="Attentes de l'ANPE" class="mt-3">
                                <div class="p-fluid">
                                    <span>Quelles actions précises attendez-vous de l'ANPE?</span>
                                    <textarea [(ngModel)]="formData.anpeExpectations" name="anpeExpectations" pInputTextarea rows="5"></textarea>
                                </div>
                            </p-fieldset>
                        </div>

                        <!-- Step 5: Documents -->
                        <div [hidden]="currentStep !== 4">
                            <p-fieldset legend="Documents requis">
                                <div class="p-fluid p-formgrid grid">
                                    <div class="field col-12 md:col-6">
                                        <label>Copie de l'extrait du RCCM</label>
                                        <p-fileUpload 
                                            mode="basic" 
                                            chooseLabel="Charger le fichier" 
                                            chooseIcon="pi pi-upload"
                                            styleClass="p-button-secondary"
                                            accept="image/*,.pdf" 
                                            (onSelect)="onFileSelect($event, 'rccmFile')"/>
                                    </div>
                                    <div class="field col-12 md:col-6">
                                        <label>Copie de l'extrait des statuts</label>
                                        <p-fileUpload 
                                            mode="basic" 
                                            chooseLabel="Charger le fichier" 
                                            styleClass="p-button-secondary"
                                            chooseIcon="pi pi-upload"
                                            accept="image/*,.pdf" 
                                            (onSelect)="onFileSelect($event, 'statutFile')"/>
                                    </div>
                                    <div class="field col-12 md:col-6">
                                        <label>Attestation CNSS</label>
                                        <p-fileUpload 
                                            mode="basic" 
                                            chooseLabel="Charger le fichier" 
                                            styleClass="p-button-secondary"
                                            chooseIcon="pi pi-upload"
                                            accept="image/*,.pdf" 
                                            (onSelect)="onFileSelect($event, 'cnssFile')"/>
                                    </div>
                                    <div class="field col-12 md:col-6">
                                        <label>Fiche de déclaration d'ouverture d'établissement</label>
                                        <p-fileUpload 
                                            mode="basic" 
                                            chooseLabel="Charger le fichier" 
                                            styleClass="p-button-secondary"
                                            chooseIcon="pi pi-upload"
                                            accept="image/*,.pdf" 
                                            (onSelect)="onFileSelect($event, 'openingDeclarationFile')"/>
                                    </div>
                                    <div class="field col-12 md:col-6">
                                        <label>Fiche de déclaration de l'inspection du travail</label>
                                        <p-fileUpload 
                                            mode="basic" 
                                            chooseLabel="Charger le fichier" 
                                            styleClass="p-button-secondary"
                                            chooseIcon="pi pi-upload"
                                            accept="image/*,.pdf" 
                                            (onSelect)="onFileSelect($event, 'workInspectionFile')"/>
                                    </div>
                                </div>
                            </p-fieldset>
                        </div>

                        <!-- Navigation buttons -->
                        <div class="flex justify-content-between mt-4">
                            <button 
                                pButton 
                                type="button"
                                label="Précédent" 
                                class="p-button-secondary" 
                                [disabled]="currentStep === 0"
                                (click)="prevStep()">
                            </button>
                            
                            <button 
                                pButton 
                                type="button"
                                label="Suivant" 
                                [disabled]="currentStep === 4"
                                (click)="nextStep()"
                                *ngIf="currentStep !== 4">
                            </button>
                            
                            <button 
                                pButton 
                                type="submit"
                                label="Soumettre" 
                                class="p-button-success" 
                                *ngIf="currentStep === 4"
                                [disabled]="!anpeForm.form.valid">
                            </button>
                        </div>
                    </form>
                </p-card>
            </div>
        </div>
        <app-footer></app-footer>
    </div>
</div>